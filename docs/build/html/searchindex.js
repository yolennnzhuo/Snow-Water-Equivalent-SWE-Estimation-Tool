Search.setIndex({"docnames": ["index", "models", "modules", "predictLSTM", "sweDataset", "tool"], "filenames": ["index.rst", "models.rst", "modules.rst", "predictLSTM.rst", "sweDataset.rst", "tool.rst"], "titles": ["Welcome to IRP\u2019s documentation!", "models module", "LSTM", "predictLSTM module", "sweDataset module", "tool module"], "terms": {"index": 0, "modul": [0, 2], "search": [0, 5], "page": 0, "class": [1, 3, 4, 5], "lstm": [1, 3, 5], "arg": [1, 4], "ani": [1, 4], "kwarg": [1, 4], "base": [1, 3, 4], "A": [1, 3, 4], "us": [1, 3, 4, 5], "repres": 1, "flexibl": 1, "architectur": [1, 5], "attribut": [1, 3, 4, 5], "num_epoch": [1, 5], "The": [1, 3, 4, 5], "number": [1, 3, 4, 5], "epoch": [1, 5], "run": [1, 5], "train": [1, 2, 3, 4, 5], "lstm_layer": 1, "list": [1, 3, 4, 5], "layer": [1, 5], "relu": 1, "activ": 1, "function": [1, 5], "fc": 1, "linear": 1, "transform": 1, "output": [1, 4, 5], "method": [1, 3, 4, 5], "forward": [1, 2], "x": [1, 3, 5], "build": [1, 5], "process": [1, 3, 4, 5], "input": [1, 3, 4, 5], "data": [1, 3, 4, 5], "throught": 1, "return": [1, 3, 4, 5], "defin": 1, "pass": [1, 3, 4], "paramet": [1, 3, 4, 5], "torch": [1, 3, 4, 5], "tensor": [1, 3, 5], "type": [1, 3, 4, 5], "train_model": [1, 2], "t": [1, 4, 5], "n_featur": 1, "train_load": [1, 4], "val_load": [1, 4], "optimis": 1, "criterion": 1, "schedul": [1, 5], "is_early_stop": [1, 5], "fals": 1, "threshold": [1, 5], "20": [1, 5], "valid": [1, 4, 5], "nn": [1, 3, 5], "int": [1, 3, 4, 5], "time": [1, 4, 5], "sequenc": [1, 4, 5], "length": [1, 4, 5], "step": [1, 4, 5], "consid": [1, 4, 5], "featur": [1, 4, 5], "util": [1, 4, 5], "dataload": [1, 4, 5], "loader": [1, 4], "optim": 1, "adam": 1, "updat": 1, "weight": 1, "dure": [1, 5], "loss": [1, 5], "calcualt": 1, "mse": [1, 5], "lr_schedul": 1, "steplr": 1, "adjust": 1, "learn": [1, 5], "rate": [1, 5], "bool": [1, 5], "option": [1, 3, 4, 5], "whether": [1, 5], "enabl": [1, 4], "earli": [1, 5], "stop": [1, 5], "default": [1, 3, 4, 5], "i": [1, 3, 4, 5], "determin": 1, "when": 1, "e": [1, 4, 5], "g": [1, 4, 5], "improv": 1, "next": 1, "continu": 1, "tupl": [1, 4, 5], "contain": [1, 5], "each": [1, 5], "model": [2, 3, 4, 5], "predictlstm": 2, "load_model": [2, 3], "model_class": [2, 3], "add_country_model": [2, 3], "add_snowclass_model": [2, 3], "input_preprocess": [2, 3], "predict_by_countri": [2, 3], "predict_by_gener": [2, 3], "predict_by_snowclass": [2, 3], "swedataset": 2, "get_data_load": [2, 4], "get_y_scal": [2, 4], "interpolate_data": [2, 4], "inverse_scale_target": [2, 4], "load_data": [2, 4], "scale_test_data": [2, 4], "scale_train_data": [2, 4], "tool": 2, "apply_perturb": [2, 5], "cal_attr": [2, 5], "cal_integrated_gradi": [2, 5], "evaluate_model": [2, 5], "grid_search": [2, 5], "kge": [2, 5], "mean_bias_error": [2, 5], "minmax_data": [2, 5], "plot_attr_over_tim": [2, 5], "plot_attribut": [2, 5], "plot_data_distribut": [2, 5], "plot_grid_search": [2, 5], "plot_loss": [2, 5], "plot_scatt": [2, 5], "plot_snow_class": [2, 5], "plot_time_seri": [2, 5], "rebuild_data": [2, 5], "split_dataset": [2, 5], "standardise_data": [2, 5], "t_test": [2, 5], "model_path": 3, "gener": 3, "sub_typ": 3, "none": [3, 5], "load": [3, 4, 5], "certain": [3, 4], "pre": [3, 5], "from": [3, 4, 5], "given": [3, 5], "path": [3, 4, 5], "str": [3, 4, 5], "where": 3, "save": 3, "categori": 3, "can": [3, 4], "countri": 3, "snowclass": 3, "further": 3, "specif": 3, "For": [3, 4], "should": [3, 5], "name": [3, 4, 5], "provid": [3, 4, 5], "user": 4, "yz6622": [], "desktop": [], "irp": [], "global_model": 3, "pth": 3, "object": [3, 5], "design": 3, "predict": [3, 4, 5], "swe": [3, 5], "valu": [3, 4, 5], "country_model": 3, "dictionari": 3, "store": 3, "snowclass_model": 3, "snow": [3, 5], "__call__": 3, "make": 3, "instanc": 3, "appropri": 3, "ensembl": 3, "all": 3, "ad": 3, "differ": [3, 5], "appli": [3, 4, 5], "locat": [3, 5], "whole": 3, "dataset": [3, 4, 5], "across": [3, 5], "add": 3, "need": [3, 4, 5], "snow_class": 3, "either": [3, 4, 5], "1": [3, 5], "2": [3, 5], "3": [3, 5], "5": [3, 5], "6": [3, 5], "input_data": 3, "convert": [3, 5], "float": [3, 5], "numpi": [3, 4, 5], "arrai": [3, 4, 5], "requir": [3, 4, 5], "call": 3, "prepar": 4, "test": [4, 5], "thi": [4, 5], "csv": [4, 5], "file": [4, 5], "direct": 4, "It": 4, "offer": 4, "interpol": 4, "scale": [4, 5], "reconstruct": 4, "partit": 4, "addit": 4, "preprocess": [4, 5], "perturb": [4, 5], "extern": 4, "through": 4, "df": [4, 5], "train_fil": [4, 5], "must": [4, 5], "both": [4, 5], "df_test": [4, 5], "test_fil": [4, 5], "var": [4, 5], "x_train": [4, 5], "x_val": [4, 5], "x_test": 4, "respect": 4, "y_train": [4, 5], "y_val": [4, 5], "y_test": 4, "target": [4, 5], "scaler_temp": 4, "scaler": [4, 5], "temperatur": 4, "scaler_minmax": 4, "h": [4, 5], "precipit": 4, "snowfal": 4, "solar_radi": 4, "scaler_i": 4, "station_sw": [4, 5], "file_path": 4, "datafram": [4, 5], "get": 4, "batch_siz": 4, "32": 4, "revers": 4, "back": 4, "origin": [4, 5], "batch": 4, "size": [4, 5], "test_load": [4, 5], "sklearn": [4, 5], "minmaxscal": 4, "linearli": 4, "variabl": [4, 5], "panda": [4, 5], "invers": [4, 5], "depth": 5, "simul": 5, "measur": 5, "error": 5, "do": 5, "augument": 5, "core": 5, "seri": 5, "perturbed_depth": 5, "seir": 5, "after": 5, "accord": 5, "2017": 5, "wmo": 5, "": 5, "guidelin": 5, "attr": 5, "calcul": 5, "mean": 5, "sum": 5, "integr": 5, "gradient": 5, "ndarrai": 5, "mean_attr": 5, "sum_attr": 5, "specifi": 5, "dimens": 5, "whose": 5, "being": 5, "which": 5, "comput": 5, "evalu": 5, "mae": 5, "r": 5, "score": 5, "plot": 5, "between": 5, "true": 5, "an": 5, "rmse": 5, "root": 5, "squar": 5, "absolut": 5, "mbe": 5, "bia": 5, "kling": 5, "gupta": 5, "effici": 5, "y_test_ori": 5, "test_pr": 5, "np": 5, "hyper_para": 5, "30": 5, "hidden_dim": 5, "50": 5, "60": 5, "step_siz": 5, "10": 5, "gamma": 5, "0": 5, "lr": 5, "001": 5, "hyper_typ": 5, "conduct": 5, "grid": 5, "over": 5, "hyper": 5, "perform": 5, "metric": 5, "note": 5, "loop": 5, "hyperparamet": 5, "r2": 5, "If": 5, "set": 5, "dimension": 5, "hidden": 5, "factor": 5, "decai": 5, "real": 5, "pred": 5, "y_true": 5, "y_pred": 5, "dtype": 5, "min": 5, "max": 5, "rang": 5, "choos": 5, "data_norm": 5, "correspond": 5, "feature_idx": 5, "one": 5, "feature_nam": 5, "titl": 5, "import": 5, "show_percentag": 5, "shift": 5, "hs_df": 5, "target_values_df": 5, "record": 5, "distribut": 5, "month": 5, "result": 5, "train_loss": 5, "val_loss": 5, "scattler": 5, "show": 5, "snowclass_gl_50km_0": 5, "50degree_2021_v01": 5, "tif": 5, "stations_csv": 5, "stations_loc": 5, "diagram": 5, "global": 5, "classif": 5, "scheme": 5, "introduc": 5, "liston": 5, "sturm": 5, "2021": 5, "station": 5, "true_valu": 5, "predictions_1": 5, "predictions_2": 5, "date": 5, "ground": 5, "truth": 5, "second": 5, "integ": 5, "indic": 5, "rebuild": 5, "shape": 5, "follow": 5, "column": 5, "col": 5, "same": 5, "loc": 5, "identifi": 5, "timestamp": 5, "associ": 5, "sampl": 5, "estim": 5, "select": 5, "optin": 5, "input_valu": 5, "target_valu": 5, "y": 5, "test_siz": 5, "random_st": 5, "42": 5, "split": 5, "proport": 5, "includ": 5, "part": 5, "seed": 5, "control": 5, "shuffl": 5, "strandard": 5, "perf_nul": 5, "perf_modif": 5, "swedata": 5, "initialis": 5, "4": 5, "initi": 5, "two": 5, "interpret": 5, "modifi": 5}, "objects": {"": [[1, 0, 0, "-", "models"], [3, 0, 0, "-", "predictLSTM"], [4, 0, 0, "-", "sweDataset"], [5, 0, 0, "-", "tool"]], "models": [[1, 1, 1, "", "LSTM"], [1, 3, 1, "", "train_model"]], "models.LSTM": [[1, 2, 1, "", "forward"]], "predictLSTM": [[3, 3, 1, "", "load_model"], [3, 3, 1, "", "model_class"], [3, 1, 1, "", "predictLSTM"]], "predictLSTM.predictLSTM": [[3, 2, 1, "", "add_country_model"], [3, 2, 1, "", "add_snowclass_model"], [3, 2, 1, "", "input_preprocess"], [3, 2, 1, "", "predict_by_country"], [3, 2, 1, "", "predict_by_general"], [3, 2, 1, "", "predict_by_snowclass"]], "sweDataset": [[4, 1, 1, "", "sweDataset"]], "sweDataset.sweDataset": [[4, 2, 1, "", "get_data_loaders"], [4, 2, 1, "", "get_y_scaler"], [4, 2, 1, "", "interpolate_data"], [4, 2, 1, "", "inverse_scale_target"], [4, 2, 1, "", "load_data"], [4, 2, 1, "", "scale_test_data"], [4, 2, 1, "", "scale_train_data"]], "tool": [[5, 3, 1, "", "apply_perturbation"], [5, 3, 1, "", "cal_attr"], [5, 3, 1, "", "cal_integrated_gradients"], [5, 3, 1, "", "evaluate_model"], [5, 3, 1, "", "grid_search"], [5, 3, 1, "", "kge"], [5, 3, 1, "", "mean_bias_error"], [5, 3, 1, "", "minmax_data"], [5, 3, 1, "", "plot_attr_over_time"], [5, 3, 1, "", "plot_attribution"], [5, 3, 1, "", "plot_data_distribution"], [5, 3, 1, "", "plot_grid_search"], [5, 3, 1, "", "plot_loss"], [5, 3, 1, "", "plot_scatter"], [5, 3, 1, "", "plot_snow_class"], [5, 3, 1, "", "plot_time_series"], [5, 3, 1, "", "rebuild_data"], [5, 3, 1, "", "split_dataset"], [5, 3, 1, "", "standardise_data"], [5, 3, 1, "", "t_test"], [5, 3, 1, "", "train"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:method", "3": "py:function"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "method", "Python method"], "3": ["py", "function", "Python function"]}, "titleterms": {"welcom": 0, "irp": 0, "": 0, "document": 0, "indic": 0, "tabl": 0, "model": 1, "modul": [1, 3, 4, 5], "lstm": 2, "predictlstm": 3, "swedataset": 4, "tool": 5}, "envversion": {"sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx": 60}, "alltitles": {"Welcome to IRP\u2019s documentation!": [[0, "welcome-to-irp-s-documentation"]], "Indices and tables": [[0, "indices-and-tables"]], "LSTM": [[2, "lstm"]], "models module": [[1, "models-module"]], "predictLSTM module": [[3, "predictlstm-module"]], "sweDataset module": [[4, "swedataset-module"]], "tool module": [[5, "tool-module"]]}, "indexentries": {"lstm (class in models)": [[1, "models.LSTM"]], "forward() (models.lstm method)": [[1, "models.LSTM.forward"]], "models": [[1, "module-models"]], "module": [[1, "module-models"], [3, "module-predictLSTM"], [4, "module-sweDataset"], [5, "module-tool"]], "train_model() (in module models)": [[1, "models.train_model"]], "add_country_model() (predictlstm.predictlstm method)": [[3, "predictLSTM.predictLSTM.add_country_model"]], "add_snowclass_model() (predictlstm.predictlstm method)": [[3, "predictLSTM.predictLSTM.add_snowclass_model"]], "input_preprocess() (predictlstm.predictlstm method)": [[3, "predictLSTM.predictLSTM.input_preprocess"]], "load_model() (in module predictlstm)": [[3, "predictLSTM.load_model"]], "model_class() (in module predictlstm)": [[3, "predictLSTM.model_class"]], "predictlstm": [[3, "module-predictLSTM"]], "predictlstm (class in predictlstm)": [[3, "predictLSTM.predictLSTM"]], "predict_by_country() (predictlstm.predictlstm method)": [[3, "predictLSTM.predictLSTM.predict_by_country"]], "predict_by_general() (predictlstm.predictlstm method)": [[3, "predictLSTM.predictLSTM.predict_by_general"]], "predict_by_snowclass() (predictlstm.predictlstm method)": [[3, "predictLSTM.predictLSTM.predict_by_snowclass"]], "get_data_loaders() (swedataset.swedataset method)": [[4, "sweDataset.sweDataset.get_data_loaders"]], "get_y_scaler() (swedataset.swedataset method)": [[4, "sweDataset.sweDataset.get_y_scaler"]], "interpolate_data() (swedataset.swedataset method)": [[4, "sweDataset.sweDataset.interpolate_data"]], "inverse_scale_target() (swedataset.swedataset method)": [[4, "sweDataset.sweDataset.inverse_scale_target"]], "load_data() (swedataset.swedataset method)": [[4, "sweDataset.sweDataset.load_data"]], "scale_test_data() (swedataset.swedataset method)": [[4, "sweDataset.sweDataset.scale_test_data"]], "scale_train_data() (swedataset.swedataset method)": [[4, "sweDataset.sweDataset.scale_train_data"]], "swedataset": [[4, "module-sweDataset"]], "swedataset (class in swedataset)": [[4, "sweDataset.sweDataset"]], "apply_perturbation() (in module tool)": [[5, "tool.apply_perturbation"]], "cal_attr() (in module tool)": [[5, "tool.cal_attr"]], "cal_integrated_gradients() (in module tool)": [[5, "tool.cal_integrated_gradients"]], "evaluate_model() (in module tool)": [[5, "tool.evaluate_model"]], "grid_search() (in module tool)": [[5, "tool.grid_search"]], "kge() (in module tool)": [[5, "tool.kge"]], "mean_bias_error() (in module tool)": [[5, "tool.mean_bias_error"]], "minmax_data() (in module tool)": [[5, "tool.minmax_data"]], "plot_attr_over_time() (in module tool)": [[5, "tool.plot_attr_over_time"]], "plot_attribution() (in module tool)": [[5, "tool.plot_attribution"]], "plot_data_distribution() (in module tool)": [[5, "tool.plot_data_distribution"]], "plot_grid_search() (in module tool)": [[5, "tool.plot_grid_search"]], "plot_loss() (in module tool)": [[5, "tool.plot_loss"]], "plot_scatter() (in module tool)": [[5, "tool.plot_scatter"]], "plot_snow_class() (in module tool)": [[5, "tool.plot_snow_class"]], "plot_time_series() (in module tool)": [[5, "tool.plot_time_series"]], "rebuild_data() (in module tool)": [[5, "tool.rebuild_data"]], "split_dataset() (in module tool)": [[5, "tool.split_dataset"]], "standardise_data() (in module tool)": [[5, "tool.standardise_data"]], "t_test() (in module tool)": [[5, "tool.t_test"]], "tool": [[5, "module-tool"]], "train() (in module tool)": [[5, "tool.train"]]}})